<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="theme-color" content="#375EAB">

  <title>parser - Go Documentation Server</title>

<link type="text/css" rel="stylesheet" href="/lib/godoc/style.css">

<script>window.initFuncs = [];</script>
<script src="/lib/godoc/jquery.js" defer></script>



<script>var goVersion = "go1.23.0";</script>
<script src="/lib/godoc/godocs.js" defer></script>
</head>
<body>

<div id='lowframe' style="position: fixed; bottom: 0; left: 0; height: 0; width: 100%; border-top: thin solid grey; background-color: white; overflow: auto;">
...
</div><!-- #lowframe -->

<div id="topbar" class="wide"><div class="container">
<div class="top-heading" id="heading-wide"><a href="/pkg/">Go Documentation Server</a></div>
<div class="top-heading" id="heading-narrow"><a href="/pkg/">GoDoc</a></div>
<a href="#" id="menu-button"><span id="menu-button-arrow">&#9661;</span></a>
<form method="GET" action="/search">
<div id="menu">

<span class="search-box"><input type="search" id="search" name="q" placeholder="Search" aria-label="Search" required><button type="submit"><span><!-- magnifying glass: --><svg width="24" height="24" viewBox="0 0 24 24"><title>submit search</title><path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/><path d="M0 0h24v24H0z" fill="none"/></svg></span></button></span>
</div>
</form>

</div></div>



<div id="page" class="wide">
<div class="container">


  <h1>
    Package parser
    <span class="text-muted"></span>
  </h1>







<div id="nav"></div>


<!--
	Copyright 2009 The Go Authors. All rights reserved.
	Use of this source code is governed by a BSD-style
	license that can be found in the LICENSE file.
-->
<!--
	Note: Static (i.e., not template-generated) href and id
	attributes start with "pkg-" to make it impossible for
	them to conflict with generated attributes (some of which
	correspond to Go identifiers).
-->

	<script>
	document.ANALYSIS_DATA = null;
	document.CALLGRAPH = null;
	</script>

	
		
		<div id="short-nav">
			<dl>
			<dd><code>import "go/parser"</code></dd>
			</dl>
			<dl>
			<dd><a href="#pkg-overview" class="overviewLink">Overview</a></dd>
			<dd><a href="#pkg-index" class="indexLink">Index</a></dd>
			
				<dd><a href="#pkg-examples" class="examplesLink">Examples</a></dd>
			
			
			</dl>
		</div>
		<!-- The package's Name is printed as title by the top-level template -->
		<div id="pkg-overview" class="toggleVisible">
			<div class="collapsed">
				<h2 class="toggleButton" title="Click to show Overview section">Overview ▹</h2>
			</div>
			<div class="expanded">
				<h2 class="toggleButton" title="Click to hide Overview section">Overview ▾</h2>
				<p>Package parser implements a parser for Go source files. Input may be
provided in a variety of forms (see the various Parse* functions); the
output is an abstract syntax tree (AST) representing the Go source. The
parser is invoked through one of the Parse* functions.
<p>The parser accepts a larger language than is syntactically permitted by
the Go spec, for simplicity, and for improved robustness in the presence
of syntax errors. For instance, in method declarations, the receiver is
treated like an ordinary parameter list and thus may contain multiple
entries where the spec permits exactly one. Consequently, the corresponding
field in the AST (ast.FuncDecl.Recv) field is not restricted to one entry.

				
			</div>
		</div>

		<div id="pkg-index" class="toggleVisible">
		<div class="collapsed">
			<h2 class="toggleButton" title="Click to show Index section">Index ▹</h2>
		</div>
		<div class="expanded">
			<h2 class="toggleButton" title="Click to hide Index section">Index ▾</h2>

		<!-- Table of contents for API; must be named manual-nav to turn off auto nav. -->
			<div id="manual-nav">
			<dl>
			
			
			
				
				<dd><a href="#ParseDir">func ParseDir(fset *token.FileSet, path string, filter func(fs.FileInfo) bool, mode Mode) (pkgs map[string]*ast.Package, first error)</a></dd>
			
				
				<dd><a href="#ParseExpr">func ParseExpr(x string) (ast.Expr, error)</a></dd>
			
				
				<dd><a href="#ParseExprFrom">func ParseExprFrom(fset *token.FileSet, filename string, src any, mode Mode) (expr ast.Expr, err error)</a></dd>
			
				
				<dd><a href="#ParseFile">func ParseFile(fset *token.FileSet, filename string, src any, mode Mode) (f *ast.File, err error)</a></dd>
			
			
				
				<dd><a href="#Mode">type Mode</a></dd>
				
				
			
			
			</dl>
			</div><!-- #manual-nav -->

		
		<div id="pkg-examples">
			<h3>Examples</h3>
			<div class="js-expandAll expandAll collapsed">(Expand All)</div>
			<dl>
			
			<dd><a class="exampleLink" href="#example_ParseFile">ParseFile</a></dd>
			
			</dl>
		</div>
		

		
			<h3>Package files</h3>
			<p>
			<span style="font-size:90%">
			
				<a href="/src/go/parser/interface.go">interface.go</a>
			
				<a href="/src/go/parser/parser.go">parser.go</a>
			
				<a href="/src/go/parser/resolver.go">resolver.go</a>
			
			</span>
			</p>
		
		</div><!-- .expanded -->
		</div><!-- #pkg-index -->

		

		
		
		
			
			
			<h2 id="ParseDir">func <a href="/src/go/parser/interface.go?s=4783:4916#L131">ParseDir</a>
				<a class="permalink" href="#ParseDir">&#xb6;</a>
				
				
			</h2>
			<pre>func ParseDir(fset *<a href="/pkg/go/token/">token</a>.<a href="/pkg/go/token/#FileSet">FileSet</a>, path <a href="/pkg/builtin/#string">string</a>, filter func(<a href="/pkg/io/fs/">fs</a>.<a href="/pkg/io/fs/#FileInfo">FileInfo</a>) <a href="/pkg/builtin/#bool">bool</a>, mode <a href="#Mode">Mode</a>) (pkgs map[<a href="/pkg/builtin/#string">string</a>]*<a href="/pkg/go/ast/">ast</a>.<a href="/pkg/go/ast/#Package">Package</a>, first <a href="/pkg/builtin/#error">error</a>)</pre>
			<p>ParseDir calls <a href="#ParseFile">ParseFile</a> for all files with names ending in &quot;.go&quot; in the
directory specified by path and returns a map of package name -&gt; package
AST with all the packages found.
<p>If filter != nil, only the files with <a href="/io/fs#FileInfo">fs.FileInfo</a> entries passing through
the filter (and ending in &quot;.go&quot;) are considered. The mode bits are passed
to <a href="#ParseFile">ParseFile</a> unchanged. Position information is recorded in fset, which
must not be nil.
<p>If the directory couldn&apos;t be read, a nil map and the respective error are
returned. If a parse error occurred, a non-nil but incomplete map and the
first error encountered are returned.

			
			

		
			
			
			<h2 id="ParseExpr">func <a href="/src/go/parser/interface.go?s=7533:7575#L228">ParseExpr</a>
				<a class="permalink" href="#ParseExpr">&#xb6;</a>
				
				
			</h2>
			<pre>func ParseExpr(x <a href="/pkg/builtin/#string">string</a>) (<a href="/pkg/go/ast/">ast</a>.<a href="/pkg/go/ast/#Expr">Expr</a>, <a href="/pkg/builtin/#error">error</a>)</pre>
			<p>ParseExpr is a convenience function for obtaining the AST of an expression x.
The position information recorded in the AST is undefined. The filename used
in error messages is the empty string.
<p>If syntax errors were found, the result is a partial AST (with <a href="/go/ast#Bad">ast.Bad</a>* nodes
representing the fragments of erroneous source code). Multiple errors are
returned via a scanner.ErrorList which is sorted by source position.

			
			

		
			
			
			<h2 id="ParseExprFrom">func <a href="/src/go/parser/interface.go?s=6243:6346#L181">ParseExprFrom</a>
				<a class="permalink" href="#ParseExprFrom">&#xb6;</a>
				
				<span title="Added in Go 1.5">1.5</span>
			</h2>
			<pre>func ParseExprFrom(fset *<a href="/pkg/go/token/">token</a>.<a href="/pkg/go/token/#FileSet">FileSet</a>, filename <a href="/pkg/builtin/#string">string</a>, src <a href="/pkg/builtin/#any">any</a>, mode <a href="#Mode">Mode</a>) (expr <a href="/pkg/go/ast/">ast</a>.<a href="/pkg/go/ast/#Expr">Expr</a>, err <a href="/pkg/builtin/#error">error</a>)</pre>
			<p>ParseExprFrom is a convenience function for parsing an expression.
The arguments have the same meaning as for <a href="#ParseFile">ParseFile</a>, but the source must
be a valid Go (type or value) expression. Specifically, fset must not
be nil.
<p>If the source couldn&apos;t be read, the returned AST is nil and the error
indicates the specific failure. If the source was read but syntax
errors were found, the result is a partial AST (with <a href="/go/ast#Bad">ast.Bad</a>* nodes
representing the fragments of erroneous source code). Multiple errors
are returned via a scanner.ErrorList which is sorted by source position.

			
			

		
			
			
			<h2 id="ParseFile">func <a href="/src/go/parser/interface.go?s=3225:3322#L74">ParseFile</a>
				<a class="permalink" href="#ParseFile">&#xb6;</a>
				
				
			</h2>
			<pre>func ParseFile(fset *<a href="/pkg/go/token/">token</a>.<a href="/pkg/go/token/#FileSet">FileSet</a>, filename <a href="/pkg/builtin/#string">string</a>, src <a href="/pkg/builtin/#any">any</a>, mode <a href="#Mode">Mode</a>) (f *<a href="/pkg/go/ast/">ast</a>.<a href="/pkg/go/ast/#File">File</a>, err <a href="/pkg/builtin/#error">error</a>)</pre>
			<p>ParseFile parses the source code of a single Go source file and returns
the corresponding <a href="/go/ast#File">ast.File</a> node. The source code may be provided via
the filename of the source file, or via the src parameter.
<p>If src != nil, ParseFile parses the source from src and the filename is
only used when recording position information. The type of the argument
for the src parameter must be string, []byte, or <a href="/io#Reader">io.Reader</a>.
If src == nil, ParseFile parses the file specified by filename.
<p>The mode parameter controls the amount of source text parsed and
other optional parser functionality. If the <a href="#SkipObjectResolution">SkipObjectResolution</a>
mode bit is set (recommended), the object resolution phase of
parsing will be skipped, causing File.Scope, File.Unresolved, and
all Ident.Obj fields to be nil. Those fields are deprecated; see
<a href="/go/ast#Object">ast.Object</a> for details.
<p>Position information is recorded in the file set fset, which must not be
nil.
<p>If the source couldn&apos;t be read, the returned AST is nil and the error
indicates the specific failure. If the source was read but syntax
errors were found, the result is a partial AST (with <a href="/go/ast#Bad">ast.Bad</a>* nodes
representing the fragments of erroneous source code). Multiple errors
are returned via a scanner.ErrorList which is sorted by source position.

			<div id="example_ParseFile" class="toggle">
	<div class="collapsed">
		<p class="exampleHeading toggleButton">▹ <span class="text">Example</span></p>
	</div>
	<div class="expanded">
		<p class="exampleHeading toggleButton">▾ <span class="text">Example</span></p>
		
		
		
			<p>Code:</p>
			<pre class="code">fset := token.NewFileSet() <span class="comment">// positions are relative to fset</span>

src := `package foo

import (
    &#34;fmt&#34;
    &#34;time&#34;
)

func bar() {
    fmt.Println(time.Now())
}`

<span class="comment">// Parse src but stop after processing the imports.</span>
f, err := parser.ParseFile(fset, &#34;&#34;, src, parser.ImportsOnly)
if err != nil {
    fmt.Println(err)
    return
}

<span class="comment">// Print the imports from the file&#39;s AST.</span>
for _, s := range f.Imports {
    fmt.Println(s.Path.Value)
}

<span class="comment"></pre>
			
			<p>Output:</p>
			<pre class="output">
&#34;fmt&#34;
&#34;time&#34;
</pre>
			
		
	</div>
</div>

			

		
		
			
			
			<h2 id="Mode">type <a href="/src/go/parser/interface.go?s=1114:1128#L37">Mode</a>
				<a class="permalink" href="#Mode">&#xb6;</a>
				
				
			</h2>
			<p>A Mode value is a set of flags (or 0).
They control the amount of source code parsed and other optional
parser functionality.

			<pre>type Mode <a href="/pkg/builtin/#uint">uint</a></pre>

			
				
				<pre>const (
    <span id="PackageClauseOnly">PackageClauseOnly</span>    <a href="#Mode">Mode</a>             = 1 &lt;&lt; <a href="/pkg/builtin/#iota">iota</a> <span class="comment">// stop parsing after package clause</span>
    <span id="ImportsOnly">ImportsOnly</span>                                       <span class="comment">// stop parsing after import declarations</span>
    <span id="ParseComments">ParseComments</span>                                     <span class="comment">// parse comments and add them to AST</span>
    <span id="Trace">Trace</span>                                             <span class="comment">// print a trace of parsed productions</span>
    <span id="DeclarationErrors">DeclarationErrors</span>                                 <span class="comment">// report declaration errors</span>
    <span id="SpuriousErrors">SpuriousErrors</span>                                    <span class="comment">// same as AllErrors, for backward-compatibility</span>
    <span id="SkipObjectResolution">SkipObjectResolution</span>                              <span class="comment">// skip deprecated identifier resolution; see ParseFile</span>
    <span id="AllErrors">AllErrors</span>            = <a href="#SpuriousErrors">SpuriousErrors</a>             <span class="comment">// report all errors (not just the first 10 on different lines)</span>
)</pre>
			

			

			
			
			

			

			
		
	

	







<div id="footer">
Build version go1.23.0.<br>
Except as <a href="https://developers.google.com/site-policies#restrictions">noted</a>,
the content of this page is licensed under the
Creative Commons Attribution 3.0 License,
and code is licensed under a <a href="/LICENSE">BSD license</a>.<br>
<a href="https://golang.org/doc/tos.html">Terms of Service</a> |
<a href="https://www.google.com/intl/en/policies/privacy/">Privacy Policy</a>
</div>

</div><!-- .container -->
</div><!-- #page -->
</body>
</html>
